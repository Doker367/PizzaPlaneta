@page "/seguimiento"
@page "/seguimiento-paquete"

<div class="tracking-page">
    <div class="tracking-card">
        <div class="tracking-header">
            <h1>Panel de Seguimiento</h1>
            <div class="tracking-search">
                <input class="tracking-input" placeholder="Número de guía o ID" @bind-value="busquedaId" @bind-value:event="oninput" />
                <button class="tracking-btn" @onclick="BuscarPaquete">Buscar</button>
            </div>
        </div>

        @if (!busquedaRealizada)
        {
            <div class="tracking-empty">Ingresa una guía para consultar su estado.</div>
        }
        else if (paquete == null)
        {
            <div class="tracking-empty">No se encontró información para "@busquedaId".</div>
        }
        else
        {
            <section class="tracking-section">
                <div class="status-row">
                    <div>
                        <div class="status-label">Estado actual</div>
                        <span class="status-badge @GetStatusClass(paquete!.Estado)">@paquete!.Estado</span>
                    </div>
                    <div class="status-meta">
                        <div><strong>Última actualización:</strong> @paquete!.FechaActualizacion.ToString("dd/MM/yyyy HH:mm")</div>
                        <div><strong>Guía:</strong> @paquete!.Id</div>
                    </div>
                </div>
                <div class="od-row">
                    <div><strong>Origen:</strong> @paquete!.Origen</div>
                    <div><strong>Destino:</strong> @paquete!.Destino</div>
                </div>
            </section>

            <section class="tracking-section">
                <h3 class="section-title">Historial de movimientos</h3>
                @if (paquete!.Historial != null && paquete!.Historial.Count > 0)
                {
                    <ul class="history-list">
                        @foreach (var mov in paquete!.Historial.OrderByDescending(h => h.Fecha))
                        {
                            <li class="history-item">
                                <span class="history-date">@mov.Fecha.ToString("dd/MM/yyyy HH:mm")</span>
                                <span class="history-desc">@mov.Descripcion</span>
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <div class="tracking-empty">Sin movimientos registrados.</div>
                }
            </section>
        }
    </div>
</div>