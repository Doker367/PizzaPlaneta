@using ManyBox.Utils
@using ManyBox.Components.Pages.Auth
@using ManyBox.Components.Layout
@using ManyBox.Components.Pages.Operaciones
@using Microsoft.AspNetCore.Components.Routing
@inject NavigationManager Navigation

<Microsoft.AspNetCore.Components.Web.ErrorBoundary>
    <ChildContent>
        @if (!SessionState.IsLoggedIn)
        {
            <Login />
        }
        else
        {
            <Router AppAssembly="typeof(App).Assembly">
                <Found Context="routeData">
                    <RouteView RouteData="routeData" DefaultLayout="typeof(MainLayout)" />
                    <FocusOnNavigate RouteData="routeData" Selector="h1" />
                </Found>
                <NotFound>
                    <LayoutView Layout="typeof(MainLayout)">
                        <div class="page-not-found text-center mt-5">
                            <h3>❌ Página no encontrada</h3>
                            <p class="text-muted">Lo sentimos, la página que buscas no existe.</p>
                            <button class="btn btn-primary" @onclick="@(() => Navigation.NavigateTo("/"))">
                                <i class="fas fa-home"></i> Volver al inicio
                            </button>
                        </div>
                    </LayoutView>
                </NotFound>
            </Router>
        }
    </ChildContent>
    <ErrorContent Context="errorContext">
        <ErrorHandler Error="@errorContext" ShowDetails="@IsDebug" />
    </ErrorContent>
</Microsoft.AspNetCore.Components.Web.ErrorBoundary>

@* La ruta /qrscanner ya está disponible por convención *@

@code {
    private bool IsDebug =>
#if DEBUG
        true;
#else
        false;
#endif
}}